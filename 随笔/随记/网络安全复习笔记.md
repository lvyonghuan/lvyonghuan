# 1. 概述

信息：信息是对客观世界中各种事物的运动状态和变化的反映，是客观事物之间相互联系和相互作用的表征

数据：数据是记录信息的形式，可以用文字、数值、图形、图像、音频和视频等多种类型的数据表示信息

信号：信号是数据的电气或电磁表现

信息具有普遍性、动态性、时效性、可传递性、可共享性与快速增长性

信息安全是指系统中的信息不会因为偶然或恶意的原因遭受破坏（可用性）、更改（完整性）、泄露（保密性），信息系统能持续不断的进行服务

信息安全的发展过程：
- 物体承载信息阶段
- 有线通信和无线通信阶段
- 计算机存储信息阶段
- 网络阶段

信息安全的目标：
- 可用性：信息被授权实体访问并按需使用
- 保密性：防止信息泄露给非授权的个人或实体，只为授权用户使用
- 完整性：信息未经授权不能改变
- 不可抵赖性：信息的发送者不能否认发送过信息，可以分为原发不可抵赖和接收不可抵赖
- 可控制性：对信息的传播过程及内容具有控制能力的特性

网络安全的内涵：
基础理论：
- 密钥生成算法（保密性）
- 加密解密算法（保密性）
- 报文摘要算法（完整性）
- 鉴别机制（防假冒）
- 数字签名方法（不可抵赖性）

安全模型：以建模的方式给出解决安全问题的方法和过程

P2DR安全模型：
- 策略：为实现信息系统的安全目标，对所有与信息系统安全相关的活动制定的规则
- 防护：信息系统的安全防护措施，由安全技术实现
- 检测：了解和评估信息系统的安全状态，发现信息系统异常行为的机制
- 响应：发现信息系统异常后采取的行动

# 2. 网络攻击

网络攻击：利用网络存在的漏洞和安全缺陷对网络中的硬件、软件及信息进行的攻击，破坏网络中信息的保密性、完整性、可用性可控制性和不可抵赖性，影响或中断网络服务。

分类：
- 主动攻击：会改变网络中的信息、状态和信息模式的攻击行为，可以破坏信息的保密性、完整性和可用性等。
  - 篡改信息
  - 欺骗攻击
  - 拒绝服务
  - 重放攻击
- 被动攻击：不会对经过网络传输的信息、网络状态和网络信息流模式产生影响的攻击行为。被动攻击一般只破坏保密性。
  - 嗅探信息
  - 非法访问
  - 数据流分析

## 2.1 嗅探攻击

原理：在终端A向终端B传输信息的过程中，信息不仅沿着终端A至终端B的路径传输，还沿着终端A至黑客终端的路径传输，且终端A至黑客路径对终端A和终端B都是透明的。

后果：
- 破坏信息的保密性
- 嗅探攻击是实现数据流分析攻击的前提
- 可以实施重放攻击

### 2.1.1 集线器和嗅探攻击

网卡的工作模式：
- 广播模式：响应目的地址为广播地址的数据帧
- 直接模式：响应目的地址与自己MAC地址相同的数据帧
- 混杂模式：接收所有数据帧

集线器嗅探攻击：黑客终端接入集线器，将网卡设置为混杂模式，可以接收所有数据帧，实现嗅探攻击。

防御措施：防止黑客终端接入集线器

### 2.1.2 交换机和MAC表溢出攻击

交换机启动时，MAC地址表无表项

交换机把hostA发出的帧源地址MAC_A与接收此帧的端口绑定，存入MAC地址表

交换机把A的帧从其他端口广播出去（除了接收A帧的端口）

交换机的地址表老化时间最长为300秒，若发现一个帧的入端口和地址表中源MAC地址不匹配，交换机将从MAC地址重新学习新的端口

MAC表溢出攻击：黑客终端发送大量伪造源MAC地址的数据帧，使交换机的MAC地址表溢出。当hostA发送数据帧时，交换机无法找到hostB的MAC地址，将数据帧广播到所有端口，黑客终端接收到数据帧，实现嗅探攻击。

防御措施：
- 防止黑客终端接入交换机
- 交换机需要防御MAC表溢出攻击

无线通信的嗅探是不可避免地，故需要对信息进行加密

## 2.2 截获攻击

原理：将终端A->终端B的传输路径改编为终端A->黑客终端->终端B

后果:
- 获取用户的私密信息
- 篡改信息
- 实施重放攻击

### 2.2.1 MAC地址欺骗攻击

1.黑客终端接入以太网
2.将自己的MAC地址伪装成hostB的MAC地址
3.发送以MAC_B为源MAC地址，以广播地址为目的地址的MAC帧。交换机会重新学习。

防御：
- 防止黑客终端接入以太网
- 阻止黑客终端发送以伪造MAC地址为源MAC地址的MAC帧进入以太网
- MAC地址绑定端口
- 限制广播帧

### 2.2.2 DHCP欺骗攻击

黑客伪造一个DHCP服务器，将其接入到网络。伪造的DHCP服务器将黑客终端的IP作为默认网关地址。

防御：
- 不允许伪造的DHCP服务器接入网络，如以太网交换机端口只允许接收经过**验证**的DHCP服务器发送的DHCP提供和确认报文

### 2.2.3 ARP欺骗攻击

正常的ARP请求：
- hostA发送ARP请求，请求hostB的MAC地址
- 以广播方式发送ARP请求
- hostB收到ARP请求后，发送ARP应答，包含自己的MAC地址。ARP应答是单播的。
- hostA不会验证应答包。

攻击者只需要发送伪造的ARP应答报文，就能够改变ARP表中的对应关系。

或者：黑客终端地址为MAC_C，伪造IP_A MAC_C的ARP请求报文，其他终端的ARP缓冲区会建立起IP A与MAC C之间的绑定。最终其他终端会把以IP A为目的地的分组封装成以MAC C为目的地的MAC帧，达到截获攻击的目的。

防御：
- 以太网交换机提供鉴别ARP请求和响应报文真伪的功能，只转发正确的ARP请求和ARP响应。
- 静态ARP表
- 监控以及早发现伪造主机

### 2.2.4 生成树欺骗攻击

生成树协议会通过阻塞端口将一个原本存在环路的以太网拓扑结构转换为树形拓扑结构。

原理：交换机被分配唯一的标识符，交换机标识符值越小，优先级越高。最小优先级的交换机被选为根交换机。

黑客终端分别通过两个以太网接口连接到交换机S1 S2，并将自己的优先级设置为最小，使得交换机S1 S2将黑客终端选为根交换机，可以截获网络中的所有数据帧。

防御：对交换机进行相互认证，不允许黑客终端参与网络生成树的建立过程。

### 2.2.5 路由项欺骗攻击

原理：黑客终端发送伪造的路由更新报文，将该路由器通向网络W的距离设置为0。路由器收到该路由项后，选择黑客终端作为通向网络W的下一跳，将通往W的数据包发送给黑客终端。

防御：
- 验证路由消息
  - 验证消息源：鉴别消息的发送端是否是合法的路由器
  - 验证消息的完整性：检查消息是否被篡改
- 确定该路由消息是由经过认证的相邻路由器发送且该路由消息传输过程中没有经过篡改后，才处理该路有消息，并根据结构更新路由表。


## 2.3 拒绝服务攻击

### 2.3.1 SYN Flood攻击

原理：黑客终端向服务器发送大量的TCP连接请求（而不响应），服务器接收到请求后，会为每个请求分配一个资源，当资源耗尽时，服务器无法再接收新的连接请求，导致服务器无法提供正常的服务。

防御：
- 缩短SYN Timeout时间（保持的SYN半连接数=SYN攻击的频度 * SYN Timeout时间）
- 设置SYN Cookie：记录某个IP的SYN请求报文
- 负反馈：设置阈值
- 退让：迅速更换自己的IP地址，放置一台“牺牲”服务器
- 分布式DNS负载均衡：将用户请求分配到不同IP的服务器主机上
- 防火墙：自动补全异常半连接，使目标主机尽早释放资源

### 2.3.2 Smurf攻击

原理：黑客终端向网络中的广播地址发送ICMP请求报文，网络中的所有主机都会收到该请求报文，所有主机都会向请求报文的源地址发送ICMP应答报文，导致源地址的网络带宽被占满。

注意，实施Smurf攻击，ICMP请求报文的源地址是被攻击的目标地址，目的地址是广播地址。

防御：
- 防止内部网络攻击：路由器使用输出过滤
- 防止网络作为中间代理
  - 设置路由器进制直接广播
  - 配置主机系统不响应ECHO报文

### 2.3.3 分布式拒绝服务（DDoS）攻击

原理：黑客通过控制大量的僵尸主机，向目标主机发送大量的数据流量，导致目标主机无法提供正常的服务。

1.搜索了解目标的情况（预攻击）：
- 了解攻击目标的主机数目、地址情况
- 目标主机的配置、性能
- 目标的带宽

2.攻击者扫描网络寻找不安全主机

3.入侵有安全漏洞的主机并获取控制权（占领傀儡机）

4.发起攻击：黑客向主控机发送攻击指令，主控机向傀儡机发送攻击指令，傀儡机向目标主机发送数据包，黑客监控攻击效果

## 2.4 欺骗攻击

### 2.4.1 源IP地址欺骗攻击

某个终端发送IP分组时，不是以该终端真实IP地址作为源IP地址，而是用其他终端的IP地址或伪造一个假IP地址作为IP分组的源IP地址，使得攻击源头难以追踪。

防御：路由器接收到某个IP分组，首先判断该IP分组的源IP地址是否和发送该IP分组终端的IP地址一致。如果不一致，终止转发过程。

### 2.4.2 钓鱼网站

（一种）实施过程：
- 伪造的DHCP服务器中给出错误的域名服务器地址
- 伪造的域名服务器给出错误的IP地址
- 导致正确的域名导向伪造的WEB服务器

防御：
- 认证真实性
- 安全意识增强

## 2.5 非法接入、非法登录

### 2.5.1 非法接入无线局域网

1.获取SSID：黑客终端可以通过侦听信标帧或探测响应帧获得AP的SSID

2.完成身份鉴别过程：
- 2.1 共享密钥鉴别机制：路由器发送challenge报文，主机处理后回送，AP进行判断是否合法
- 2.2 黑客通过监听challenge response报文即可获得加密对应关系，从而能够应答AP的challenge报文

防御：AP不通过一次性密钥K异或随机数P生成的密文Y来证明授权终端拥有共享密钥GK

### 2.5.2 非法登录

非授权用户远程登录网络设备和服务器并对网络设备和web服务器进行非法配置的攻击行为。

通过截获合法用户信息获取用户名密码、暴力破解和社会工程学

防御：
- 授权用户正常登陆时，以密文方式向网络设备和web服务器传输用户身份标识信息，如用户名和口令。
- 要求网络设备和WEB服务器设置的口令必须有一定的复杂度

## 2.6 黑客入侵

信息收集、扫描、渗透、攻击

# 3. 加密算法

对称密钥体制、非对称密钥体制，两种密钥体制的特点与适用范围

## 3.1 基本概念和分类

### 3.1.1 加密解密的本质

加密前的原始信息被称为明文，加密后的信息被称为密文，加密过程就是明文->密文的转化过程。为了保障信息的保密性，不能通过密文了解明文的内容。明文至密文的转换过程必须是可逆的，解密过程就是加密过程的逆过程，是密文至明文的过程。

### 3.1.2 传统的加密解密算法

- 凯撒密码：将明文中的每个字母按照字母表顺序向后移动固定的位数
- 换位密码：将明文中的字母按照一定的规则重新排列

### 3.1.3 现代加密解密算法

定义：明文m，密文c，加密算法E，加密密钥ke，解密算法D和解密密钥kd

明文m转换成密文c的过程如下：

c=E(m,ke)

加密过程是以明文m和加密密钥ke为输入的加密函数运算过程。c=E(m,ke)也可表示为c=E<sub>ke</sub>(m)。

密文c转换为明文m的过程如下：

m=D(c,kd)

解密是以密文c和解密密钥kd为输入的解密函数运算过程。

m=D(c,kd)也可表示为m=D<sub>kd</sub>(c)

密码体制要求满足：D<sub>kd</sub>(E<sub>ke</sub>(m))=m

---

规定明文集合M，由明文m的二进制数位确定。如果明文m的二进制数位为nm，则明文集合M中的元素个数为2<sup>nm</sup>。

规定密文集合C，由密文c的二进制数位确定。如果密文c的二进制数位为nc，则密文集合C中的元素个数为2<sup>nc</sup>。

加密密钥集合KE，由加密密钥ke的二进制数位确定。如果加密密钥ke的二进制数位为nke，则加密密钥集合KE中的元素个数为2<sup>nke</sup>。（包含了2<sup>nke</sup>个不同的密钥）

解密密钥集合KD，由解密密钥kd的二进制数位确定。如果解密密钥kd的二进制数位为nkd，则解密密钥集合KD中的元素个数为2<sup>nkd</sup>。（包含了2<sup>nkd</sup>个不同的密钥）

现代密码体制的原则是：所有加密解密算法都是公开的，保密的只是密钥。

## 3.2 加密传输过程

发送端将明文m和加密密钥ke作为加密函数E的输入，加密函数E的运算结果是密文c。

密文c沿着发送端至接收端的传输路径到达接收端。

接收端将密文c和解密密钥作为解密函数D的输入，解密函数D的运算结果是明文m。

## 3.3 密码体制分类

如果加密密钥ke等于解密密钥kd，这种密钥体制称为对称密钥体制。

如果ke不等于kd，且无法由一个密钥直接导出另一个密钥，这种密钥体制被称为非对称密钥体制。非对称密钥体制也称为双密钥密码体制。

两种密钥体制的特点：
- 对称密钥体制的特点是密钥分发和保护困难。
- 非对称密钥体制的特点是密钥分发容易。
- 非对称密钥体制的加密解密复杂度相比之下更大。

### 3.3.1 对称密码体制

- 分组密码体制和流密码体制
- 分组密码体制
- 流密码体制
- 对称密钥体制的密钥分配过程

#### 3.3.1.1 分组密码体制和流密码体制

1.安全性要求：
- 唯密文攻击（攻击者只能获得密文）
- 已知明文攻击（攻击者同时拥有一些明文和对应的密文）
- 选择明文攻击（攻击者可以选择任意明文并获得对应的密文）
- 选择密文攻击（攻击者可以选择任意密文获得对应的明文）

2.安全密码体制实现思路：

存在两种实现安全密码体制的方法：
- 可以重复使用密钥k，但是加密解密算法必须复杂到能够防御选择明文攻击和选择密文攻击，且这种防御攻击的能力已经被官方证明。
- 一次一密钥，每一次加密运算使用不同的密钥，且密钥必须在足够强大的密钥集中随机产生，确保密钥之间没有关联性，攻击者无法根据已知的有限密钥序列推导出下一次用于加密运算的密钥。对加密解密算法的复杂性没有要求。
- 分组密码体制针对第一种方法，流密码体制针对第二种方法。流密码体制又被称为序列密码体制。

#### 3.3.1.2 分组密码体制

分组密码体制的本质：输入是n位明文m和b位密钥k，输出是n位密文c，表示成E<sub?>k</sub>(m)=c

首先对任意长度的明文进行填充，使填充后的明文长度是加密算法要求的长度的整数倍。然后将填充后的明文分割成加密算法规定长度的数据段。对每一段数据进行独立的加密运算，产生和数据段长度相同的密文，密文序列和明文分段后产生的数据段序列一一对应。

分组密码体制的加密算法完成的是n位的明文至n位的密文之间的映射。同样，解密算法完成的是n位密文至n位明文之间的映射。n位明文至n位密文之间的映射关系多达2<sup>n</sup>!。密钥k的值用于在多达2<sup>n</sup>!的映射种选择一种映射，由此导出2<sup>n</sup>个明文编码和2<sup>n</sup>个密文编码之间的对应关系。

举例：Feistel愤怒中密码结构。

替代运算：将数据段中的二进制数分段，每一段二进制数用对应的编码代替。

置换运算：置换运算是按照置换规则重新排列数据段中的二进制数的顺序。

数据加密标准：64位名为呢首先进行初始置换，初始置换结构被分成两个部分：L<sub>0</sub>和R<sub>0</sub>，他们称为Feistel分组密码结构的原始输入。经过16次迭代运算，得到输出L<sub>n+1</sub>和R<sub>n+1</sub>。对其进行初始置换对应的逆置换，结构就是**DES加密运算**后的密文。

DES迭代函数：进行扩展运算，分割后进行替代运算，再组合进行置换运算。迭代若干轮。

AES略。

---

电密码本模式：明文分段，每一段单独加密产生密文，各段密文组合成最终密文。

缺点：如果明文内容有规律重复，密文内容也有规律重复，降低了保密性。

加密分组链模式：
- 加密过程：初始向量与明文段进行异或运算，加密获得了明文Y1，密文Y(i-1)与明文段i进行异或运算，加密获得密文Yi。
- 解密过程：对密文段Y1进行解密运算，和初始向量进行异或，获得明文段P1。Dk（Yi），结果与Yi-1异或，获得明文Pi。
- 特点：重复的明文内容不会产生重复的密文。改变初始向量可以使明文产生不同的密文，加强了保密性。

#### 3.3.1.3 流密码体制

有无穷大的密钥集，密钥不可能重复，密钥之间没有相关性。

密文Y=明文与密钥Ki的异或，容易根据明文和密文得出密钥，Ki=明文异或密文。

密钥的安全性在于不重复、不可预测。

代表：WEP（略）

#### 3.3.1.4 对称密钥体制的密钥分配过程

1. 用户A向KDC发送请求：E<sub>kA</sub>(A,B)
2. KDC分配会话密钥R1，向用户A发送E<sub>kA</sub>(R1||E<sub>kB</sub>(A,R1))
3. 用户A解开密文，向用户B发送E<sub>kb</sub>(A,R1)
4. 双方使用R1加密数据。

### 3.3.2 非对称密钥体制

#### 3.3.2.1 非对称密钥算法原理

发送者用加密算法E和密钥PK对明文m进行加密，接收者用解密算法D和密钥Sk对密文c进行解密。加密密钥PK是公开的，而解密密钥SK是保密的，只有接收者知道。（反过来也行）

- 容易承兑生成密钥PK和SK
- 加密解密算法公开且可对调：DSK(EPK(m))=EPK(DSK(m))=m
- 加密解密容易实现
- 从计算可行性讲，无法根据PK导出SK
- 从计算可行性讲，无法根据PKD和密文c推导明文m

#### 3.3.2.2 RSA公开密钥加密算法

RSA公开密钥加密算法是一种分组密码算法，每一组数据m是0~n-1的整数，n和密钥长度有关。

c=m<sup>e</sup>mod n

m=c<sup>d</sup> mod n= (m<sup>e</sup>)<sup>d</sup> mod n= m<sup>ed</sup> mod n

能够找到......原理略

#### 3.3.2.3 公开密钥加密算法密钥分发原则

1. 成对生成加密密钥和解密密钥
2. 公告加密密钥，保存解密密钥
3. 需要证明密文接收者和加密密钥之间的绑定关系

### 3.3.3 两种密钥体制的特点和适用范围

对称密钥算法的优势是加密解密运算简单，计算量少，劣势是分发困难。公开密钥加密算法的劣势是加密解密运算过程复杂，计算量较大，优势是密钥分发简单，可以通过有公信力的传播媒介公告密钥。

结合：发送端随机产生密钥K，用密钥K和对称密钥加密算法加密给接收端的数据m，产生密文c1，用接收端的公钥加密对称密钥k，产生密文c2，可以达到分发对称密钥的效果。

# 4.报文摘要

- 完整性检测
- 算法特点
- 主要算法

## 4.1 完整性检测

1. 检错码：
   检错码c=f(D)（D为要传输的数据，f是报文摘要算法）。假定接收端同时收到c1和d1，只有c1=f(d1)时，接收端确认传输过程正确。
2. 报文摘要和完整性检测过程：
   发送端检错码c=Ek(f(D))。接收端解密c1得到报文摘要后的c，对d1进行报文摘要，对比是否相等。

## 4.2 报文摘要算法特点

假定MD为报文摘要算法，MD(X)是算法对报文X作用后产生的标识信息，MD必须满足如下条件：
- 能够作用于任意长度的报文
- 易于实现
- 具有单向性。只能根据报文X求出MD(x)，无法根据MD(X)求出报文X。
- 具有抗碰撞性。对于任意一个报文X无法找到另一个报文Y，X!=Y，但MD(X)=MD(Y)
- 具有高灵敏性，即使只改变报文X中的一位二进制，也能使计算后的MD(X)变化很大。

## 4.3 主要的报文摘要算法

- MD5(已经不安全，无法防止碰撞)
- SHA-2
- HMAC

## 4.4 报文摘要应用

- 完整性检测(开头已讲)
- 消息鉴别
- 口令存储
- 数字签名

### 4.4.1 消息鉴别

为了实现消息鉴别，一是使接收端和发送端X拥有相同的密钥K，且密钥K只有接收端和发送端X知道。二是对消息M，指的发送端X生成的附加消息C=Ek(MD(m))

### 4.4.2 口令安全存储

防止黑客窃取用户账号，对于每个账号计算机不明存储，而是存储口令的报文摘要。如果某个账户的口令是PASS，计算机种存储MD(PASS)。PASS传达到计算机之后进行报文摘要，比对是否合法。

### 4.4.3 数字签名

数字签名用于解决网络传输种信息的真实性问题，有如下特征：
- 接收者能够合适发送者对报文的数字签名
- 发送者事后无法否认对报文的数字签名
- 接收者无法伪造发送者对报文的数字签名

基于RSA的数字签名：
1. Epka(Dska(P))=P，通过PKA加密还原的一定是通过SKA解密运算的结果
2. 无法根据报文摘要h，求出报文X，使得MD(X)=h

根据上述规则，一旦满足MD(P)=Epka(数字签名)，得出数字签名=Dska(MD(p)),可以断定报文P由知道私钥SKA的用户发送，知道私钥SKA的用户是和公钥PKA绑定的用户。

**使用私钥加密、公钥解密。验证的是发送者拥有该私钥，该私钥和发送者绑定，从而确认发送者的身份。**

证书略。

# 5. 接入控制

- 身份鉴别
- 其他略

## 5.1 身份鉴别

- 身份鉴别定义和分类
- 主体身份标识信息
- 单向鉴别过程
- 双向鉴别过程
- 第三方鉴别过程

定义：验证主体的真实身份与其所声称的身份是否符合的过程——主体可以是用户、进程和主机等。

实施：主体拥有*唯一的身份标识*（前提），主体以**安全的方式**（防重放、防假冒）向对方证明其拥有这个标识信息。

分类：
- 单向鉴别：只有主体A鉴别主体B的身份，主体B不鉴别主体A的身份。
- 双向鉴别：主体A B互相鉴别对方身份。
- 第三方鉴别：第三方分发给主机AB身份标识信息，主机AB以此进行身份鉴别。

### 5.1.1 主体身份标识信息

1. 密钥：主体拥有某个密钥x，只要主体能够证明自己知道密钥x，就可证明
2. 用户名和口令：为每个授权用户分配用户名和口令，某个用户只要能够证明自己知道某个授权用户对应的用户名和口令，就能证明自己是授权用户。
3. 证书和私钥：证书可以证明主体x与公钥PK之间的绑定关系，如果主体x能够证明自己知道公钥PK对应的私钥SK，就能够证明自己是主体x。

### 5.1.2 单向鉴别过程

基于共享密钥：主体A只需要证明自己知道共享密钥k，即可证明自己的身份。

主体B向主体A发送随机数R，主体A回送EK(R)，主体B验证Dk(Ek(R))是否等于R

---

基于用户名和口令：主体A只需要证明自己知道某个授权用户对应的用户名和口令，即可证明自己身份。

主体B发送随机数R防止重放，请求主体A的用户名和口令。主体A发送自己的用户名，密码和随机数做MD的结果。主体B取出主体A的口令，将发送的R和取出的口令做MD，比对是否和收到的MD结果一致。

---

基于证书和私钥：证书证明主体A的公钥是PKA。

主体B发送随机数R给主体A，主体A私钥加密，主体B公钥解密后查看结果是否和发送的相同即可证明。

### 5.1.3 双向鉴别过程

基于共享密钥：每一方不仅需要证明自己知道共享密钥，还要证明对方知道共享密钥。

主体B发送随机数RB，主体A发送Ek(RA||RB)，主体B回送EK(RA)

---

基于用户名口令：

主体A需要证明主体B知道用户名对应的口令。

主体B发送RB，主体A发送用户名A，RA，MD(RB||PASSA)，主体B发送MD(RA||PASSA)，主体A将收到的结果和自己的运算结果比对。

---

基于证书和私钥

用户A和用户B各自公钥的绑定得到了权威机构的证明，且用户A B能够证明自己知道公钥对应的私钥。

主体B发送RB，主体A回送DSKA(RA||RB)，主体B用公钥解开后私钥加密RA回送DSKB(RA)，主体A用公钥解开验证是否一致。

### 5.1.4 第三方鉴别

无需鉴别者查找验证证书，由专门的权威机构执行验证功能。

1. 主体A向公钥管理机构发送请求||时间（时间戳，防止重放攻击）
2. 公钥管理机构下发DSK(PKB||请求||时间1)
3. 主体A解开取得PKB，向主体B发起请求EPKB(主体A||RA)
4. 主体B以同样的流程向公钥管理机构请求PKA
5. 主体B回送EPKA(RA||RB)
6. 主体A回送EPKB(RB)

# 6. 安全协议

- IPSec
- TLS
- 应用层安全协议
- IPSec、TLS和应用层安全协议比较

安全协议产生的原因：
- 源端鉴别问题
- 数据传输的保密性问题
- 数据传输的完整性问题
- 身份鉴别问题——接收端身份鉴别

安全协议功能：
- 双向身份鉴别
  - 共享密钥
  - 公钥证书
- 数据加密
  - 对称加密算法
  - 混合密码体制
- 数据完整性检测
  - 报文摘要算法HAMC
  - 数字签名
- 防重防攻击机制
  - 序列号、序列窗口
- 防否认
  - 数字签名

协商并实现加密算法、协商并实现摘要算法、实现密钥分发及其它安全参数协商、安全封装传输数据

报文摘要和完整性检测过程（参考报文摘要部分）

---

HMAC完成完整性检测过程：明文P经过HMAC得到HMAC(P)，作为明文P的附加信息，一起经过PKB加密形成数字信封。主机B使用私钥解密，再对明文进行HMAC，比对是否和附加信息相等。
- 身份鉴别：基于密钥K
- 完整性检测：报文摘要
- 保密性：报文加密

---

基于公钥的完整性检测：对MD(P)用私钥加密形成数字签名。参考前文。
- 消息源鉴别：公钥对应的私钥
- 消息完整性鉴别：对摘要的签名
- 不可抵赖性：数字签名

## 6.1 IPSec

1. AH协议：数据完整性、数据源身份认证、防重放攻击
2. ESP协议：数据完整性认证、数据源身份认证、防重放攻击、**加密服务**
3. IKE协议：双向身份鉴别、协商加密算法、认证算法、密钥等安全参数

---

安全关联：
1. 安全关联是特定通信保护相关联的安全套件集合，安全关联(Sercurity Assoicitation，SA)保护单向通信（双向通信建立连两个安全关联），安全关联的唯一标识：安全参数索引（SPI），目标的IP地址，安全协议标识符
2. SA参数
   - 序列号计数器
   - 重放窗口：合法的包序列范围
   - AH信息：认证算法、密钥、密钥生存期等
   - ESP信息：加密和认证算法、密钥、初始值、密钥生存期等
   - 生存期：时间或字节数
   - 模式：传输模式或隧道模式
   - Path MTU：最大传输单元
  
发送者A需要建立与发送者B的安全关联(SPI1||IP_B||安全协议标识符)，同理，发送者B也需要建立与发送者A的安全关联(SPI2||IP_A||安全协议标识符)

---

建立数据与安全关联之间的绑定：
1. 将数据分类：
   - 数据源IP地址
   - 目的IP地址
   - 使用的传输层协议
   - 源端口号
   - 目的端口号
   - 使用的安全协议
   - 要求的服务类型
   - .....
2. 对不同的数据施加不同的安全关联：
   - 丢弃
   - 使用IPSec
   - 不使用IPSec

---

传输模式：保护的数据为IP分组的净荷，如TCP UDP报文和其他基于IP的上层协议报文

隧道模式：保护的数据是IP分组，将整个IP分组作为另一个IP分组的净荷的封装方式、隧道可以建立在任意两个网络节点之间，安全关联的两端是隧道的两端，点到点的保护数据安全。

传输模式：
```
IP头|IPSec头|payload
```

隧道模式：
```
新IP头|IPSec头|IP头|payload
```

对于AH协议：
```
传输模式下：

IPV4:

IP头|AH头|IP载荷

IPV6:

IP头|多跳、路由分段|AH头|目的选项|IP载荷

隧道模式下：

IPV4:

新IP头|AH头|IP头|IP载荷

IPV6:

新IP头|新扩展头|AH头|IP头|扩展头|IP载荷

AH协议的验证区域包括整个IP部分，没有加密区域。
```

对于ESP协议：
```
传输模式下：

IPV4:

IP头|ESP头|IP载荷|ESP尾|验证数据

IPV6：

IP头|多跳、路由分段|ESP头|目的选项|IP载荷|ESP尾|验证数据

隧道模式下：

IPV4:

新IP头|ESP头|IP头|IP载荷|ESP尾|验证数据

IPV6：

新IP头|新扩展头|ESP头|IP头|扩展头|目的选项|IP载荷|ESP尾|验证数据

对于ESP协议，验证区域从ESP头到ESP尾，不包括IP头；加密区域从IP载荷（IPV6包括目的选项）到ESP尾。
```

IPSec防止重放攻击原理：
1. 黑客可以重复转发截获的AH或ESP报文，或是延迟一段时间再转发截获的AH或ESP报文
2. 目的端每接收到一个AH或ESP报文，执行如下操作（接收窗口，参考TCP滑动窗口，窗口大小设为W，窗口末端序号为N）：
   - 如果报文序列小于N-W+1，或者该序号对应的报文已经正确接收，则丢弃该报文。
   - 如果报文序号在窗口范围内，且未接收过该序列号对应的报文，接收该报文并且将该序号对应的标志修改未已接收
   - 如果报文序号大于N，假定为L，将窗口改为L-W+1~L，并且将序号L对应的标志改为已正确接收该序号对应的报文。

## 6.2 AH协议

协议格式：
- 下一个头：8bit，表示紧跟在AH头的下一个载荷的类型，如6(TCP) 17(UDP) 50(ESP) 4(IP，表示隧道模式)
- 负载长度：8bit，AH载荷的长度，以32bit字为单位的整个AH数据（包括头部和变长认证数据）减去2
- 保留域：8bit，置0
- 安全参数索引（SPI），32bit，0~255保留，有效值为256~2^32-1.与源地址或目的的地址以及AH来共同标识一个安全关联。
- 序列号：单调递增的计数器，为每个AH包赋予一个序号，当通信双方建立SA时，初始化为0。SA是单向的，每发送一个，外出SA的计数器增加1，每接收一个，进入SA的计数器加1。和接收窗口配合进行防重放。
- 验证数据：变长字段，必须为32的整数倍，否则填充。为完整性校验值（ICV）或MAC,ICV的算法由SA指定，为了保证互操作性，规定必须的算法HMAC-MD5-96和HMAC-SHA-1-96

## 6.3 ESP协议

ESP协议和TCP UDP协议一样都是被IP封装的协议，可以由IP头的协议字段判断，ESP协议的协议字段为50。

协议格式：
- 安全参数索引（SPI）：32bit，与源地址或目的地址以及ESP头共同标识一个安全关联
- 序列号：32bit，单调递增的计数器，为每个ESP包赋予一个序号，当通信双方建立SA时，初始化为0。SA是单向的，每发送一个，外出SA的计数器增加1，每接收一个，进入SA的计数器加1。和接收窗口配合进行防重放。
- 载荷数据：变长字段。如果采用了加密，该部分为加密后的数据，如果没有加密，该部分为明文数据。字段长度必须是8位的整数倍。
- 填充：范围为0~255字节，为了保证ESP的边界适合加密算法的需要。
- 填充长度：范围0-255，填充的长度，指出上面填充了多少字节的数据，接收端可以根据此恢复载荷数据的真实长度。
- 下一个头：指明在何种的数据类型。参考前文。（隧道模式为4）
- 验证数据：变长，参考前文。

## 6.4 AH协议与ESP协议共用

AH头应当置于ESP头前，这样AH头可以验证IP头，ESP可以加密载荷。如果AH头放置于ESP头内，那样AH头会被加密，起不到验证IP头的效果了。

## 6.5 IKE

静态安全关联与动态安全关联：静态安全关联由人工在发送端和接收端的安全关联数据库种配置。动态安全关联根据安全传输数据的需要，通过协商建立发送端到接收端的安全关联，协商与安全关联相关的参数。（通过协商自动建立安全关联）

动态安全关联建立过程：建立安全传输通道、建立安全关联

## 6.6 TLS

引出原因：对于C/S架构，实现双向身边鉴别与相互交换数据的保密性和完整性是非常重要的。需要有一套完成双向身份鉴别和数据安全性的协议。

TLS前身是SSL。

- TLS握手协议：实现双向身份鉴别和安全参数（压缩算法、加密算法、MAC算法、加密密钥、MAC密钥等）协商
- 改变密码规范协议：通知双方使用新约定的安全参数
- 记录协议：封装上层协议消息，实现源端鉴别、保密性和完整性
- 报警协议：用于传输出错消息，如解密失败，无法确认证书等

流程：应用数据分块、压缩、计算MAC、加密、封装在SSL头之后。

MAC计算略。

---

SSL握手协议：在应用程序的数据传输之前运行，服务器和客户机相互验证，协商加密和MAC算法以及保密密钥。分为四个阶段：
1. 建立安全协商
2. 服务器鉴别和密钥交换
3. 客户鉴别和密钥交换
4. 完成握手协议

建立安全协商：
1. client hello（版本，随机数，会话ID，密码算法列表，压缩方法列表）
2. server hello（支持最高版本，服务器随机数，会话ID，挑出的密码算法，挑出的压缩方法）

服务器鉴别和密钥交换（服务器向客户端通信）：
1. 服务器发送证书
2. 发送密钥交换所需的信息（D-H全局参数和公钥、RSA公钥）
3. server hello done(必选)

客户端鉴别和密钥交换：
1. 客户端发送证书
2. 发送密钥交换信息（必选0
3. 发送客户证书验证信息

完成握手协议（阶段四，略）

---

修改密文协议：
- 待定状态：协商完成之后数据通信前SSL进入待定状态（也叫挂起状态、等待状态）
- 协议消息：由单个消息change gipher spec组成，该消息只含有一个值为1的单个字节
- 协议作用，将挂起状态拷贝为当前状态，更新用于当前连接的密码组。为保证安全性，每隔一段时间应该改变加密规范。

告警协议：
- level=1，warning
- =2，fatal

---

TLS与SSL的区别：
- MAC计算不同
- 密钥计算不同
- 报警码支持SSL3.0的所有报警
- 密码套件不同
- 客户端证书类型不同
- certificate verify和完成消息不同
- 填充不同

## 6.7 HTTPS

在TCP的技术上建立TLS安全连接，经过TLS安全连接实现对web服务器的身份鉴别和传输的HTTP消息的保密性、完整性和源端鉴别

## 6.8 应用层安全协议

- dns sec
- set（通信安全、防否认，购物场景）
- pgp（电子邮件）
- s/mime

# 10. VPN

通过Internet实现企业局域网之间、远程终端与内部网络之间的互联。具有专用网络所具有的安全性。

隧道技术是VPN的基本技术：
- 利用隧道协议对数据包进行封装，允许私有IP地址为源和目的IP地址
- 在隧道建立过程种完成双端身份鉴别
- 通过加密和报文摘要算法保证经过隧道传输的信息的保密性和完整性
- 隧道协议可以在网络的不同层封装数据

VPN分类;
- 二层隧道L2TP和IPSec：实现远程用户安全接入企业网内部，利用IPSec保障安全
- 三层隧道和IPSec：实现企业局域网之间以私有IP地址为源和目的地址的IP分组传输
- SSL VPN：实现远程用户安全接入企业网内部，利用SSL保障安全

## 10.1 第三层隧道和IPSec

通用路由封装（GRE）：一种网络协议封装在另一种网络层协议

新IP头|GRE头|上层协议数据|网络层GRE模块

- 新IP头：协议号为47，运输协议
- GRE头：如果报文目的地址确定需要隧道，则启用GRE封装。运载协议或封装协议。
- 上层协议数据：乘客协议

启用GRE头的数据包可以再加上ESP协议（与AH协议），实现IPSec。这样需要在GRE头外的IP之上再加入一层IP（隧道模式）

## 10.2 第二层隧道和IPSec

传统远程接入：
1. 语音通信
2. 建立PPP链路
3. 鉴别远程用户身份，分配私有IP地址

远程终端与接入控制设备独占点对点信道。

---

第二层VPN
- 点对点隧道协议（PPTP）：默认端口1723（TCP）
- 第二次隧道协议（L2TP）：默认端口号1701（UDP）

L2TP：强制隧道比自愿隧道多一个ISP接入控制设备，用它建立隧道。

L2TP的两个阶段：
1. 建立控制连接连接，实现可靠传输
2. 通过控制协议建立第二层隧道

多个隧道建立可以共享相同的控制连接

---

PPP帧封装在第二层隧道的数据当中。将PPP的协议、数据、CRC字段作为L2TPv3的载荷，再封装进UDP报文。

## 10.3 VPN控制接入

路由R为了实现远程终端VPN接入，需要在注册用户库种配置注册用户名、口令和鉴别机制。为了给远程终端分配用于访问内部网络资源的本地IP地址，需要在路由器R定义本地IP池。

过程：
1. 远程终端与路由器R建立第二层隧道。
2. 远程终端与路由器R建立基于第二层隧道的PPP链路。
3. 路由器R完成对远程终端用户的身份鉴别。
4. 路由器在本地IP池中选择一个未使用的给远程终端，并和第二层隧道绑定。

## 10.4 SSL VPN

第二层隧道和IPSec对远程终端的访问权限没有限制，远程终端需要安装专用客户端，内部网络对远程终端不透明，无法实现基于用户授权。

SSL VPN的核心设备是SSL VPN网关，一端分配全球IP地址，一端接入内部网络，分配内部IP地址。远程终端可以用访问其他连接在internet上的web服务器一样登录SSL VPN网关，之间采用HTTPS。

SSL VPN网关与内部网络各个服务器之间建立传输通路，通过响应应用层协议完成访问内部网络中各个服务器的过程。

# 11. 防火墙

防火墙位于网络之间，或终端与网络之间，对传输的信息流实施控制。
- 能够检测用于实施攻击的信息流并阻断
- 能允许正常信息流通过

基本工作机制：
- 依据配置的安全策略允许或阻断操作
- 可以工作在不同层上

分类：
- 个人防火墙
  - 分组过滤器
    - 无状态分组过滤器
    - 有状态分组过滤器
- 网络防火墙
  - 分组过滤器
    - 无状态分组过滤器
    - 有状态分组过滤器
  - 电路层代理
  - 应用层网关

---

个人防火墙：保护单台计算机，对进出计算机的信息流实施控制，通常是分组过滤器。

网络防火墙
- 分组过滤器
- 电路层代理
- 应用层网关

---

防火墙功能：
- 服务控制：不同网络间只允许传输特定服务相关的信息流
- 方向控制：不同网络间只允许传输与特定网络中断发起的会话相关的信息流
- 用户控制：不同网络间只允许传输与授权用户合法访问网络资源相关的信息流
- 行为控制：不同网络之间只允许传输行为合理的网络资源访问过程相关的信息流

局限性：
- 无法防御网络内部攻击
- 无法阻止病毒传播
- 无法防御利用防火墙安全策略允许的信息传输过程实施的攻击行为

## 11.1 分组过滤器

### 11.1.1 无状态分组过滤器

数据包传入防火墙，逐行读取规则，匹配则停止，独立的对单个分组进行过滤。

过滤规则：由一组属性值和操作组成，如果某个IP分组携带的信息和某个规则的一组属性值匹配，对该IP分组实施规则指定的操作。

构成规则的属性通常由以下字段组成：
- 源IP地址
- 目的IP地址
- 源和目的端口号
- 协议类型

---

两种过滤规则集设置方法：
1. 黑名单
2. 白名单

---

例如：禁止网络193.1.1.0/24中的终端用Telnet访问服务器193.1.2.5，允许其它通信

协议类型=TCP，源IP=193.1.1.0/24，目的IP=193.1.2.5/32，目的端口=23；丢弃

### 11.1.2 有状态分组过滤器

在无状态分组过滤器的基础上规定连接的方向，如只允许终端A发起建立的web服务器之间的TCP连接。

有状态分组过滤器会检查与会话相关的信息，关联属于一个会话的所有数据包。也能分析应用层协议，检查请求报文和响应报文之间的关联性。

基于分区防火墙：将网络划分成不同的区，控制不同区之间的访问。

有状态分组防御器防御SYN洪泛攻击——阈值控制：
- 半连接数量达到阈值，发送RST=1，开始释放
- 设定每秒允许发起的TCP连接请求的数量，超出阈值丢弃

cookie技术:记录IP防御SYN洪泛攻击

防御侦察机制——IP地址扫描：
- 在防火墙连接非信任区的端口启动防御IP地址扫描机制
- 设置时间间隔t和阈值n，在每隔时间段t内检测具有相同源的IP地址，不同目的IP地址的ICMP ECHO request报文，允许前N个继续转发，丢弃后续的，直到下一个时间段开始。

防御侦察机制——端口扫描：
- 设置时间间隔t和阈值n，每个时间段t检测相同源IP地址，不同目的端口的TCP连接请求报文，允许前n个通过，后续丢弃，直到下个时间段开始。

防御机制-操作系统扫描：
- 拦截控制位置位异常的TCP报文

## 11.2 NAT技术

NAT用于转换内部IP地址和外部IP地址。

- 静态NAT：把内部网络的某个内部主机地址永久映射成某个全球地址。
- 动态地址NAT：把一系列合法全球地址动态分配映射到内部本地地址。
- 端口多路复用NAT(PAT)：把内部本地地址映射到一个内部全球地址的不同端口上，也可以是静态或者动态。

### 11.2.1 静态NAT

将建立本地地址和全球IP地址的固定关联，这样允许外部网络中断随时通过该全球IP地址访问对应的内部网络终端。

应用：TCP负载均衡。将一台虚拟主机映射到几台真实机器上。当外部用户访问虚拟主机时，路由器会把各个访问轮流映射到各个主机上，达到负载均衡的效果。

### 11.2.2 动态NAT

在会话开始时从全球IP地址池分配一个未使用的IP地址，并在地址转换表将全球IP地址与本地地址之间的绑定会话关联在一起，会话结束取消绑定和关联。

内部网络终端对于外网透明，并且只允许内部网络终端发起建立和外部网络终端之间的会话，增强了内部网络的安全性。

---

### 11.2.3 NAT的弱安全性：

1. 除了静态NAT和静态PAT外，在内部网络终端发起某个会话前，外部网络终端是无法访问到内部网络终端的，因此，也无法发起对内部网络终端的攻击，这是NAT被作为网络安全机制的主要原因。
2. 对外屏蔽了内网的结构

## 11.3 电路层代理

在源和目的之间的中继设备，使源和目的不直接通信

通过三种技术实现远程终端访问内部网络：
- 静态端口映射
- VPN
- 电路层代理

规避访问限制技术：
- VPN
- 电路层代理

电路层代理可以穿透防火墙

---

电路层代理的安全功能：
- 数据中继：通过映射表
- 用户身份鉴别：基于用户进行访问控制
- 传输层检测：检测字段值的正确性

## 11.4 应用层网关

检测层次：
- 分组过滤器：IP和传输层首部
- 电路层代理：传输层首部
- 应用层网关：应用层首部与消息体

分组过滤器对源主机和目的主机时透明的，电路层代理对源主机是不透明的，应用层网关可以工作在透明模式和代理模式（反向代理）上。

安全功能：保护应用服务器。防御黑客对web服务器实施攻击（如sql注入）

---

透明模式：应用层网关在传输路径上，对流经消息进行检测

反向代理模式：应用层网关不在传输路径上，终端访问应用层网关，应用层网关检测后转发给web服务器，web服务器回送消息可以不经过应用层网关。

## 11.5 三种防火墙的特点

1. 分组过滤器的安全功能：检测所有IP分组
2. 电路层代理的安全功能：实现基于用户的访问控制
3. 应用层网关的安全功能：防御针对特定服务器实施的攻击

# 12. 入侵检测

入侵：所有破坏网络可用性、保密性和完整性的行为

入侵手段：恶意代码、非法访问和拒绝服务攻击等

引出IDS的原因：防火墙体系无法防御内部网络攻击

- 事件发生器：提供入侵检测系统分析的数据（事件）：
  1. 网段信息流
  2. 对操作系统内核的操作请求
  3. 日志文件信息
  4. 报文内信息
- 事件分析器：根据事件数据库中的入侵特征描述、用户历史行为模型等信息，对事件发生器提供的事件进行分析，得出事件是否合法的结论
- 事件数据库：存储用于作为判别事件是否合法的依据的信息：
  1. 攻击行为描述
  2. 攻击特征描述
  3. 用户历史行为
  4. 统计阈值
  5. 检验规则
- 响应单元：根据事件分析器的分析结果做出反应：丢弃IP分组；释放TCP连接；报警；登记和分析；终止应用进程；拒绝操作请求；改变文件属性

---

- 在线模式：IDS直接连接在链路上，实时检测反制，处理能力要求高
- 杂凑模式：IDS旁接在关键链路上，不能实时反制，但对信息传输过程没有影响

网络入侵检测系统工作过程：
- 捕获信息
- 检测异常信息
- 反制异常信息

入侵检测的不足之处：
- 主机入侵防御系统：
  - 被动防御
  - 每一台主机都配置的成本太高
  - 安全策略难于一致
- 网络入侵防御系统：
  - 能实现主动防御，但只保护部分网络资源
  - 对未知攻击行为的检测存在难度

---

入侵检测系统的评价指标：
- 正确性（误报率）
- 全面性（漏报率）
- 性能

---

## 12.1 网络入侵检测系统

1. 探测器接入集线器，利用集线器的广播传输功能获取信息。
2. 探测器接入交换机，将交换机中的某个端口作为另一个端口的镜像，所有从该端口输出的信息流都被复制到镜像端口。镜像端口与其他端口之间的关系是动态的，可以捕获任意端口的输出。
3. 跨交换机端口镜像捕获信息。探测器接入交换机2，交换机2和交换机1之间通过vlan连接，再基于此进行端口镜像
4. 虚拟路由

---

- 攻击特征检测
- 协议译码
- 异常检测（显著区别于正常网络信息流的信息流）

## 12.2 主机入侵检测系统

防黑客防病毒等，拦截系统调用等。

# 13. 病毒防御

- U盘AutoRun病毒
- 宏病毒
- 脚本病毒
- PE病毒
- 蠕虫病毒

病毒激发机制：
- 嵌入BIOS和引导区
- 作为自启动项
- 修改名字

破坏过程：
- 设置后门
- 监控用户操作
- 破坏硬盘信息
- 破坏bios
- 发起拒绝服务
- 蠕虫蔓延

## 13.1 基于主机的防御技术

- 基于特征扫描：提取病毒特征，建立病毒特征库
- 基于线索扫描：分析可执行文件入口处的代码功能确定文件是否感染病毒
- 基于完整性扫描：对系统所有文件建立报文摘要
- 基于行为检测：防止用户进程发出修改注册表等操作
- 基于模拟环境检测：在模拟环境运行查看病毒是否激发了某种行为

## 13.2 基于网络的防御技术

- 防火墙
- 网络入侵检测系统
- 防毒墙
- 数字免疫系统

# 14 计算机安全技术

主体（Subject）是指主动的实体，该实体造成了信息的流动和系统状态的改变。

客体（Object）是指包含或接受信息的被动实体。对客体的访问意味着对其中所包含的信息的访问。

访问是使信息在主体和客体间流动的一种交互方式。

访问控制是一种具有以下功能的安全机制，一是能保障授权用户获取所需资源，二是能拒绝非授权用户非法获取资源。

身份鉴别一是需要对主体分配唯一标识符，二是主体能够提供证明身份的标识信息

授权是为每一个用户设置访问权限，某个用户的访问权限是指该用户允许访问的客体和允许对客体进行的操作。

---

访问控制模型：
- 自主访问控制模型
  - 访问矩阵模型
    - 访问控制表
    - 访问能力表
- 强制访问控制模型
  - 保密性模型
    - Bell-Lapudula模型
  - 完整性模型
    - Biba模型
- 基于角色的访问控制模型

---

自主访问控制模型：目前计算机实现最多的访问控制机制，根据访问者的身份和授权决定访问模式的一种策略，允许某个主体对其拥有的信息资源显示地指定其他主体是否可以访问以及可以执行的操作类型。

基于访问控制矩阵可以派生出访问控制表和访问能力表。

访问控制表以客体（文件）为中心（主流os文件系统方案），用于客体集中管理的应用环境

访问能力表以主体（用户）为中心，为每个用户分配访问权限，用于客体分布式管理的应用环境，可以由访问控制主机统一完成身份鉴别过程。

---

强制访问控制模型：指系统强制主体服从事先制定的访问控制策略

系统事先给访问主题和受控个体分配不同的安全级别属性，访问控制时，系统比较主体和客体的安全级别属性，再决定主体能否访问客体。

- 下读上写实现了保密性（BLP模型）
- 上读下写实现了完整性（BIBA模型）

---

基于角色的访问控制：角色分配。参考数据库的角色。
